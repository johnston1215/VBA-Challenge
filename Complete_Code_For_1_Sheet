Sub DefineVariables()

'--Define variables
Dim Ticker As String
Dim OpenPrice As Double
Dim ClosePrice As Double
Dim Volume As Double
Dim TotalVolumeRow As Integer
Dim PercentChange As Double
Dim AnnualChange As Double
Dim PerInc As Double
Dim PerDec As Double
Dim ActTick As String

'--Make sure to save file as XLSM

End Sub
Sub ReportResults()

'--Create columns to report results
For Each ws In ThisWorkbook.Worksheets
ws.Range("i1").Value = "Ticker"
ws.Range("j1").Value = "Yearly Change"
ws.Range("k1").Value = "Percent change"
ws.Range("l1").Value = "Total Stock Volume"
ws.Range("n2").Value = "Greatest % Inc"
ws.Range("n3").Value = "Greatest % Dec"
ws.Range("o1").Value = "Ticker"
ws.Range("p1").Value = "Value"
Next

End Sub
Sub Test1()

'Dim Ticker As String
'Dim Volume As Double
Volume = 0
'Dim TotalVolumeRow As Integer
TotalVolumeRow = 2
'Dim PercentChange As Double
'Dim OpenPrice As Double
OpenPrice = Range("c3")
'Dim ClosePrice As Double
'Dim AnnualChange As Double
LastRow = 70926

'For Each ws In Worksheets
'LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row

    For d = 2 To LastRow
'--Check to see if tickers match
    If Cells(d + 1, 1).Value <> Cells(d, 1).Value Then
'--If they don't match, assign current ticker as "active" ticker and print in the summary table
        Ticker = Cells(d, 1).Value
        Range("I" & TotalVolumeRow).Value = Ticker
'--Total all previous volume accumulations for active ticker and print in the summary table
        Volume = Volume + Cells(d, 7).Value
        Range("L" & TotalVolumeRow).Value = Volume
'--Assign Closing date to current ticker
        ClosePrice = Cells(d, 6).Value
'--Find difference between close price and open price and print in the summary table
        AnnualChange = ClosePrice - OpenPrice
        Range("j" & TotalVolumeRow).Value = AnnualChange
        PercentChange = AnnualChange / OpenPrice
        Range("k" & TotalVolumeRow).Value = PercentChange
'--Reset the Open price
        OpenPrice = Cells(d + 1, 3)
'--New summary table line assigned for next ticker and reset volume accumulator
        TotalVolumeRow = TotalVolumeRow + 1
        Volume = 0
'--If tickers DO match, then accumulate additional volume
    Else
        Volume = Volume + Cells(d, 7).Value
    End If
    Next d
    
'--Convert Percentage numbers to % format
    For p = 2 To LastRow
    Range("K" & p).NumberFormat = "0.00%"
    Next p
    
'--Find Greatest % Increase and Decrease
    
    'Dim PerInc As Double
    'Dim PerDec As Double
    'Dim ActTick As String
    PerInc = 0
    PerDec = 0
    
    For i = 2 To LastRow
'--If the active %inc is > current %inc, then it becomes new Current inc%
        If Cells(i, 11) > PerInc Then
            PerInc = Cells(i, 11).Value
            ActTick = Cells(i, 9).Value
        End If
    Next i
'--Report results
    Range("o2") = ActTick
    Range("p2") = PerInc
        
    For d = 2 To LastRow
'--If the active %dec is < current %dec, then it becomes new Current dec%
        If Cells(d, 11) < PerDec Then
            PerDec = Cells(d, 11).Value
            ActTick = Cells(d, 9).Value
        End If
    Next d
'--Report results
    Range("o3") = ActTick
    Range("p3") = PerDec
    
'--Convert Percentage numbers to % format
    For p = 2 To 3
    Range("p" & p).NumberFormat = "0.00%"
    Next p
    
'--Conditionally Format cells
    For A = 2 To LastRow
    If Range("K" & A) > 0 Then
        Range("K" & A).Interior.ColorIndex = 4
    Else
        Range("K" & A).Interior.ColorIndex = 3
    End If
    Next A
    
'Next ws

End Sub
