Sub Test1()

'For Each ws In Worksheets
'LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row

Volume = 0
TotalVolumeRow = 2
OpenPrice = Range("c3")
LastRow = 70926

    For d = 2 To LastRow
'--Check to see if tickers match
    If Cells(d + 1, 1).Value <> Cells(d, 1).Value Then
'--If they don't match, assign current ticker as "active" ticker and print in the summary table
        Ticker = Cells(d, 1).Value
        Range("I" & TotalVolumeRow).Value = Ticker
'--Total all previous volume accumulations for active ticker and print in the summary table
        Volume = Volume + Cells(d, 7).Value
        Range("L" & TotalVolumeRow).Value = Volume
'--Assign Closing date to current ticker
        ClosePrice = Cells(d, 6).Value
'--Find difference between close price and open price and print in the summary table
        AnnualChange = ClosePrice - OpenPrice
        Range("j" & TotalVolumeRow).Value = AnnualChange
        PercentChange = AnnualChange / OpenPrice
        Range("k" & TotalVolumeRow).Value = PercentChange
'--Reset the Open price
        OpenPrice = Cells(d + 1, 3)
'--New summary table line assigned for next ticker and reset volume accumulator
        TotalVolumeRow = TotalVolumeRow + 1
        Volume = 0
'--If tickers DO match, then accumulate additional volume
    Else
        Volume = Volume + Cells(d, 7).Value
    End If
    Next d
    
'--Convert Percentage numbers to % format
    For p = 2 To LastRow
    Range("K" & p).NumberFormat = "0.00%"
    Next p
    
'--Find Greatest % Increase, Decrease & Total Volume
    
    'Dim PerInc As Double
    'Dim PerDec As Double
    'Dim ActTick As String
    PerInc = 0
    PerDec = 0
    TotVol = 0
    
    For i = 2 To LastRow
'--If the active %inc is > current %inc, then it becomes new Current inc%
        If Cells(i, 11) > PerInc Then
            PerInc = Cells(i, 11).Value
            ActTick = Cells(i, 9).Value
        End If
    Next i
'--Report results
    Range("o2") = ActTick
    Range("p2") = PerInc
        
    For d = 2 To LastRow
'--If the active %dec is < current %dec, then it becomes new Current dec%
        If Cells(d, 11) < PerDec Then
            PerDec = Cells(d, 11).Value
            ActTick = Cells(d, 9).Value
        End If
    Next d
'--Report results
    Range("o3") = ActTick
    Range("p3") = PerDec
    
    For v = 2 To LastRow
'--If the active Total Volume is > Current total volume, then it becomes new Current Total Volume
        If Cells(v, 12) > TotVol Then
            TotVol = Cells(v, 12).Value
            ActTick = Cells(v, 9).Value
        End If
    Next v
'--Report results
    Range("o4") = ActTick
    Range("p4") = TotVol
    
'--Convert Percentage numbers to % format
    For p = 2 To 3
    Range("p" & p).NumberFormat = "0.00%"
    Next p
    
'--Conditionally Format cells
    For A = 2 To LastRow
    If Range("K" & A) > 0 Then
        Range("K" & A).Interior.ColorIndex = 4
    Else
        Range("K" & A).Interior.ColorIndex = 3
    End If
    Next A
    
'Next ws

End Sub
